<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Happy Hideouts - Project Proposal</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Happy Hideouts</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./projectproposal.html" rel="" target="" aria-current="page">
 <span class="menu-text">Project Proposal</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#problem-motivation" id="toc-problem-motivation" class="nav-link active" data-scroll-target="#problem-motivation">1. Problem &amp; Motivation</a></li>
  <li><a href="#project-objectives" id="toc-project-objectives" class="nav-link" data-scroll-target="#project-objectives">2. Project Objectives</a></li>
  <li><a href="#main-features" id="toc-main-features" class="nav-link" data-scroll-target="#main-features">3. Main Features</a></li>
  <li><a href="#data-source" id="toc-data-source" class="nav-link" data-scroll-target="#data-source"><strong>4. Data Source</strong></a></li>
  <li><a href="#literature-review" id="toc-literature-review" class="nav-link" data-scroll-target="#literature-review"><strong>5. Literature Review</strong></a>
  <ul>
  <li><a href="#spatial-variability-of-the-airbnb-effect-a-spatially-explicit-analysis-of-airbnbs-impact-on-housing-prices-in-sydney" id="toc-spatial-variability-of-the-airbnb-effect-a-spatially-explicit-analysis-of-airbnbs-impact-on-housing-prices-in-sydney" class="nav-link" data-scroll-target="#spatial-variability-of-the-airbnb-effect-a-spatially-explicit-analysis-of-airbnbs-impact-on-housing-prices-in-sydney">Spatial Variability of the ‘Airbnb Effect’: A Spatially Explicit Analysis of Airbnb’s Impact on Housing Prices in Sydney</a></li>
  <li><a href="#airbnb-price-prediction-in-the-age-of-social-distancing" id="toc-airbnb-price-prediction-in-the-age-of-social-distancing" class="nav-link" data-scroll-target="#airbnb-price-prediction-in-the-age-of-social-distancing">Airbnb Price Prediction in the Age of Social Distancing</a></li>
  </ul></li>
  <li><a href="#comparison-to-existing-applications" id="toc-comparison-to-existing-applications" class="nav-link" data-scroll-target="#comparison-to-existing-applications"><strong>6. Comparison to Existing Applications</strong></a>
  <ul>
  <li><a href="#predictive-price-modelling-for-airbnb-listings-global" id="toc-predictive-price-modelling-for-airbnb-listings-global" class="nav-link" data-scroll-target="#predictive-price-modelling-for-airbnb-listings-global">Predictive Price Modelling for Airbnb listings (Global)</a></li>
  <li><a href="#our-application-happy-hideouts" id="toc-our-application-happy-hideouts" class="nav-link" data-scroll-target="#our-application-happy-hideouts">Our application: Happy Hideouts</a></li>
  </ul></li>
  <li><a href="#ui-prototype" id="toc-ui-prototype" class="nav-link" data-scroll-target="#ui-prototype"><strong>7. UI Prototype</strong></a></li>
  <li><a href="#application-architecture" id="toc-application-architecture" class="nav-link" data-scroll-target="#application-architecture"><strong>8. Application Architecture</strong></a></li>
  <li><a href="#timeline" id="toc-timeline" class="nav-link" data-scroll-target="#timeline"><strong>9. Timeline</strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Project Proposal</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="problem-motivation" class="level2">
<h2 class="anchored" data-anchor-id="problem-motivation">1. Problem &amp; Motivation</h2>
<p>The residential rental market in Singapore is a very complex market with many variables that can affect a rental price of a property. For example, according to property guru a HDB rental rate per month can range from $2000 dollars to $4200 dollars depending on location and the type of unit. Factoring private property into the equation will only widen the range in rental rates per month and further complicate the rental decision of prospective tenants. This has sparked our interest as many of our foreign exchange peers have pointed out that they have encountered trouble navigating the complex residential rental market in Singapore. &nbsp;</p>
<p>To simplify the residential rental market in Singapore, our aim is to create an interactive web application that would allow prospective tenants to carry out analysis of different Airbnb listings simply through interacting with the user interface. This would allow prospective tenants to view Airbnb listings on the map simply by specifying type of listings and regions that they are interested in. Additionally, they would also be able to get an estimate of the price of a listing that they are interested in through geospatial weighted regression.&nbsp;</p>
</section>
<section id="project-objectives" class="level2">
<h2 class="anchored" data-anchor-id="project-objectives">2. Project Objectives</h2>
<ol type="1">
<li>Conduct exploratory data analysis and plot a map of Airbnb listings in Singapore to gain an understanding of where Airbnb listings in Singapore are located.</li>
<li>Conduct first-order spatial point pattern analysis:&nbsp;Deriving Kernel Density Estimation layer for visualizing and exploring the intensity of Airbnb listings in Singapore. &nbsp;</li>
<li>Conduct second-order spatial point pattern analysis: Analyse Spatial point processes using appropriate G, F, K and L functions. Performing Complete Spatial Randomness test using Monte Carlo simulations to confirm the observed spatial patterns. &nbsp;</li>
<li>Conduct Local Measures of Spatial Autocorrelation: Using local Moran’s or local Geary’s C statistical method to detect Spatial Custers and outliers.</li>
<li>Conduct Geographically Weighted Regression: Building Multiple Linear Regression model and Hedonic Pricing model to predict prices of Airbnb listings. &nbsp;</li>
</ol>
</section>
<section id="main-features" class="level2">
<h2 class="anchored" data-anchor-id="main-features">3. Main Features</h2>
<ol type="1">
<li>Allow users to view various analysis done such as Kernel Density Estimation and hotspots and coldspots so that it can inform their decision making when choosing an airbnb location to stay for long term.</li>
<li>Allow users to view predicted prices of Airbnb listings in that region. This gives them negotiating power and allows them to make more informed decisions on where they want to stay.</li>
</ol>
</section>
<section id="data-source" class="level2">
<h2 class="anchored" data-anchor-id="data-source"><strong>4. Data Source</strong></h2>
<p>The data is sourced from Inside Airbnb (<a href="http://insideairbnb.com/get-the-data" class="uri">http://insideairbnb.com/get-the-data</a>), a global registry of airbnb listings related information from around the world. You can retrieve spatial data of listings from the portal as well as aspatial summary information about each listings. Points of interest are identified with a regions hotspot and coldspots. Hotspots can be determined by factors such as regions with high commercial centres which makes them attractive to stay near. Meanwhile coldspots may occur are regions with lower quality of life and less amenities nearby. It can function as a good indicator of affordable housing for short term stayers.</p>
</section>
<section id="literature-review" class="level2">
<h2 class="anchored" data-anchor-id="literature-review"><strong>5. Literature Review</strong></h2>
<section id="spatial-variability-of-the-airbnb-effect-a-spatially-explicit-analysis-of-airbnbs-impact-on-housing-prices-in-sydney" class="level4">
<h4 class="anchored" data-anchor-id="spatial-variability-of-the-airbnb-effect-a-spatially-explicit-analysis-of-airbnbs-impact-on-housing-prices-in-sydney">Spatial Variability of the ‘Airbnb Effect’: A Spatially Explicit Analysis of Airbnb’s Impact on Housing Prices in Sydney</h4>
<p>Source: <a href="https://www.mdpi.com/2220-9964/11/1/65" class="uri">https://www.mdpi.com/2220-9964/11/1/65</a></p>
<p>Hotspot and coldspot analysis were done that revealed Airbnb hotspots were clustered around the City CBD, and the Eastern (Bondi) and Northern (Manly) Beaches near the coastal area. This could be explained by high tourism rates in Sydney that led to them staying in more airbnbs. This trend cannot be extrapolated to Singapore as Singapore’s unique airbnb ban prevents airbnb hosts from hosting for less than 3 months. Interesting temporal observations were made about the housing price growth in Sydney that led to more expensive airbnb prices. This could be applied to Singapore as well.</p>
</section>
<section id="airbnb-price-prediction-in-the-age-of-social-distancing" class="level4">
<h4 class="anchored" data-anchor-id="airbnb-price-prediction-in-the-age-of-social-distancing">Airbnb Price Prediction in the Age of Social Distancing</h4>
<p>Source: <a href="https://escholarship.org/content/qt4x28127g/qt4x28127g_noSplash_f792aead22e835be56acb36696a4ceef.pdf?t=qq9jkf" class="uri">https://escholarship.org/content/qt4x28127g/qt4x28127g_noSplash_f792aead22e835be56acb36696a4ceef.pdf?t=qq9jkf</a></p>
<p>With social distancing, airbnb users were no longer interested in staying in airbnb for short term visits since heavy travel restrictions were imposed during those times. Instead they opted for longer term visits and as such apartments with longer stay duration faced higher prices and shorter stays faced dropping prices with lower demand. Textual methods such as topic modelling with Latent Dirichlet Allocation were used to gauge users’ interest in listings from the reviews they posted.</p>
<p>However, this analysis did not make use of geospatial analysis in their prediction, which gives us room to improve on this model with our geospatial analysis.</p>
</section>
</section>
<section id="comparison-to-existing-applications" class="level2">
<h2 class="anchored" data-anchor-id="comparison-to-existing-applications"><strong>6. Comparison to Existing Applications</strong></h2>
<section id="predictive-price-modelling-for-airbnb-listings-global" class="level4">
<h4 class="anchored" data-anchor-id="predictive-price-modelling-for-airbnb-listings-global">Predictive Price Modelling for Airbnb listings (Global)</h4>
<p>Source: <a href="https://www.deepakkarkala.com/docs/articles/machine_learning/airbnb_price_modeling/about/index.html" class="uri">https://www.deepakkarkala.com/docs/articles/machine_learning/airbnb_price_modeling/about/index.html</a></p>
<p>Aspatial features such as listing price and booking availability, were used to predict future prices of airbnb. This project is targetted at hosts who are looking to optimally price their houses. However, this dataset is biased to cities such as Paris, London, New York, Berlin, Los Angeles which have the most number of listings. This could lead to a class imbalance problem during data exploration and prediction which is undesirable for a city with less observations in the dataset. By making our study specific to one city such as Singapore, we hope it will give users looking to rent in Singapore a better understanding of prices so that they can rent out airbnbs conveniently.</p>
</section>
<section id="our-application-happy-hideouts" class="level3">
<h3 class="anchored" data-anchor-id="our-application-happy-hideouts">Our application: Happy Hideouts</h3>
<p>Compared to past analysis, our analysis will make use of spatial and temporal features to predict listing prices for longer term stay in Singapore since Singapore bans the use of airbnb for stays of less than 3 months. Thus we expect that the target audience of Singapore’s airbnb scene will be very different from regular Airbnb users in other countries such as Los Angeles in the study “Airbnb Price Prediction in the Age of Social Distancing”. For instance, many exchange students and foreigners who are looking to stay in Singapore for work reasons may make up this target audience. Thus these unique set of users will find this application particularly useful.</p>
</section>
</section>
<section id="ui-prototype" class="level2">
<h2 class="anchored" data-anchor-id="ui-prototype"><strong>7. UI Prototype</strong></h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">1 - Homepage</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">2 - EDA</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">3 - Spatial Analysis</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">4 - Hotspot &amp; Coldspot Area Analysis</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">5 - Prediction (Regression)</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><img src="images/Screenshot 2024-03-01 at 1.02.03 PM.png" class="img-fluid"></p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p><img src="images/Screenshot 2024-03-01 at 1.02.18 PM.png" class="img-fluid"><br>
</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p><img src="images/Screenshot 2024-03-01 at 1.02.32 PM.png" class="img-fluid"></p>
<p><img src="images/Screenshot 2024-03-01 at 1.03.40 PM.png" class="img-fluid"></p>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p><img src="images/Screenshot 2024-03-01 at 1.04.27 PM.png" class="img-fluid"></p>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<p><img src="images/Screenshot 2024-03-01 at 1.04.55 PM.png" class="img-fluid"></p>
</div>
</div>
</div>
</section>
<section id="application-architecture" class="level2">
<h2 class="anchored" data-anchor-id="application-architecture"><strong>8. Application Architecture</strong></h2>
<p><img src="images/architecturaldiagram-01.png" class="img-fluid"></p>
</section>
<section id="timeline" class="level2">
<h2 class="anchored" data-anchor-id="timeline"><strong>9. Timeline</strong></h2>
<p><img src="images/IS415 timeline.png" class="img-fluid"></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>